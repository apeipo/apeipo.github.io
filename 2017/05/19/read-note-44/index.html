<!DOCTYPE html><html><head><meta charset="utf-8"><title>博文阅读笔记 - 四月 | linxianlong的博客</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="NOTE,"><meta name="description" content="2017-04-06 检查Linux服务器性能命令原文链接uptime查看系统1分钟、5分钟、15分钟内的负载，表示等待CPU的进程和阻塞的进程(D状态)数量。如果15分钟的负载高1分钟的负载低，说明机器说明机器紧张状态在缓解。如果15分钟的低而1分钟的高，说明机器负载在加大，需要排查CPU占用。vmstat 1vmstat 1表示每秒输出一次r是等待在CPU资源的进程数si，so是交换区写入和读"><meta name="keywords" content="NOTE"><meta property="og:type" content="article"><meta property="og:title" content="博文阅读笔记 - 四月"><meta property="og:url" content="http://longlog.me/2017/05/19/read-note-44/index.html"><meta property="og:site_name" content="linxianlong的博客"><meta property="og:description" content="2017-04-06 检查Linux服务器性能命令原文链接uptime查看系统1分钟、5分钟、15分钟内的负载，表示等待CPU的进程和阻塞的进程(D状态)数量。如果15分钟的负载高1分钟的负载低，说明机器说明机器紧张状态在缓解。如果15分钟的低而1分钟的高，说明机器负载在加大，需要排查CPU占用。vmstat 1vmstat 1表示每秒输出一次r是等待在CPU资源的进程数si，so是交换区写入和读"><meta property="og:locale" content="default"><meta property="og:image" content="https://longlog-1300108443.cos.ap-beijing.myqcloud.com/before2019/2017-05-19-14909389945639.jpg"><meta property="og:image" content="https://longlog-1300108443.cos.ap-beijing.myqcloud.com/before2019/2017-05-19-14909466663411.jpg"><meta property="og:updated_time" content="2019-08-29T07:09:16.069Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="博文阅读笔记 - 四月"><meta name="twitter:description" content="2017-04-06 检查Linux服务器性能命令原文链接uptime查看系统1分钟、5分钟、15分钟内的负载，表示等待CPU的进程和阻塞的进程(D状态)数量。如果15分钟的负载高1分钟的负载低，说明机器说明机器紧张状态在缓解。如果15分钟的低而1分钟的高，说明机器负载在加大，需要排查CPU占用。vmstat 1vmstat 1表示每秒输出一次r是等待在CPU资源的进程数si，so是交换区写入和读"><meta name="twitter:image" content="https://longlog-1300108443.cos.ap-beijing.myqcloud.com/before2019/2017-05-19-14909389945639.jpg"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/styles.css"><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?bec693dc99391bbe29dd7310e3fff81a";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head></html><body><div class="post-header LEFT"><div class="toolbox"><ul class="list-toolbox"><li class="item-toolbox"><a class="CIRCLE" href="/">首页</a></li><li class="item-toolbox"><a class="CIRCLE" href="/categories/">分类</a></li><li class="item-toolbox"><a class="CIRCLE" href="/tags/">标签</a></li><li class="item-toolbox"><a class="CIRCLE" href="/link/">友链</a></li><li class="item-toolbox"><a class="CIRCLE" href="/about/">关于</a></li></ul></div><div class="toolbox tool-vertical" id="tool-vertical"><ul class="list-toolbox list-vertical"><li class="item-toolbox"><a class="CIRCLE VERTICAL" href="/">首页</a></li><li class="item-toolbox"><a class="CIRCLE VERTICAL" href="/categories/">分类</a></li><li class="item-toolbox"><a class="CIRCLE VERTICAL" href="/tags/">标签</a></li><li class="item-toolbox"><a class="CIRCLE VERTICAL" href="/link/">友链</a></li><li class="item-toolbox"><a class="CIRCLE VERTICAL" href="/about/">关于</a></li></ul></div><script type="text/javascript">function getStyle(e){return void 0===e.currentStyle?getComputedStyle(e):e.currentStyle}window.onscroll=function(){var e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,t=document.getElementsByClassName("toolbox")[0],l=document.getElementById("tool-vertical"),o=getStyle(l).display,n=document.getElementsByClassName("CIRCLE VERTICAL");if(60<=e&&"none"==o){l.style.display="block",t.style.display="none";for(var s=0;s<n.length;s++)n[s].setAttribute("class","CIRCLE VERTICAL")}if(e<60&&"block"==o)for(t.style.display="block",setTimeout("document.getElementById('tool-vertical').style.display = 'none'",600),s=0;s<n.length;s++)n[s].setAttribute("class",n[s].className+" a-vertical")}</script></div><div id="toc" class="toc-article"><strong class="toc-title">文章目录</strong><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#2017-04-06-检查Linux服务器性能命令"><span class="toc-text">2017-04-06 检查Linux服务器性能命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#uptime"><span class="toc-text">uptime</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vmstat-1"><span class="toc-text">vmstat 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mpstat-P-ALL-1"><span class="toc-text">mpstat-P ALL 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pidstat-1"><span class="toc-text">pidstat 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#iostat-xz-1"><span class="toc-text">iostat -xz 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sar-n-DEV-1"><span class="toc-text">sar -n DEV 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sar-n-TCP-ETCP-1"><span class="toc-text">sar -n TCP,ETCP 1</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2017-04-01-从日志统计到大数据分析"><span class="toc-text">2017-04-01 从日志统计到大数据分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据采集"><span class="toc-text">数据采集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据传输"><span class="toc-text">数据传输</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据驱动"><span class="toc-text">数据驱动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据分析"><span class="toc-text">数据分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据系统的架构"><span class="toc-text">数据系统的架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#元数据"><span class="toc-text">元数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#元数据的好处"><span class="toc-text">元数据的好处</span></a></li></ol></li></ol></li></ol></div><div class="content-post LEFT"><article id="post-read-note-44" class="article article-type-post" itemscope itemprop="blogPost"><header class="article-header"><h1 class="post-title">博文阅读笔记 - 四月</h1><div class="article-meta"><span>2017-05-19</span> <span>| </span><span class="article-author">Linxianlong</span> <span>| </span><span class="article-category"><a class="article-category-link" href="/categories/NOTE/">NOTE</a></span></div></header><div class="article-content"><h2 id="2017-04-06-检查Linux服务器性能命令"><a href="#2017-04-06-检查Linux服务器性能命令" class="headerlink" title="2017-04-06 检查Linux服务器性能命令"></a>2017-04-06 检查Linux服务器性能命令</h2><p><a href="http://mp.weixin.qq.com/s?__biz=MjM5MDE0Mjc4MA==&amp;mid=2650994146&amp;idx=1&amp;sn=f6b0987a06831805b4c343c417121827&amp;chksm=bdbf0db18ac884a7166b4f440f577148b72d08b6ec72f368a4e7898877cbadfa36b2a1cba1c0&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">原文链接</a></p><h3 id="uptime"><a href="#uptime" class="headerlink" title="uptime"></a>uptime</h3><p>查看系统1分钟、5分钟、15分钟内的负载，表示等待CPU的进程和阻塞的进程(D状态)数量。如果15分钟的负载高1分钟的负载低，说明机器说明机器紧张状态在缓解。如果15分钟的低而1分钟的高，说明机器负载在加大，需要排查CPU占用。</p><h3 id="vmstat-1"><a href="#vmstat-1" class="headerlink" title="vmstat 1"></a>vmstat 1</h3><ol><li><code>vmstat 1</code>表示每秒输出一次</li><li>r是等待在CPU资源的进程数</li><li>si，so是交换区写入和读取的数量。如果这个数据不为0，说明系统已经在使用交换区（swap），机器物理内存已经不足</li><li>us（用户时间）, sy（系统时间）, id（空闲时间）, wa（IO等待时间）</li></ol><p>如果IO等待时间长，那么瓶颈在于磁盘IO。如果用户时间长，说明是应用程序在消耗CPU时间</p><h3 id="mpstat-P-ALL-1"><a href="#mpstat-P-ALL-1" class="headerlink" title="mpstat-P ALL 1"></a>mpstat-P ALL 1</h3><p>查看每个CPU的时间占用</p><h3 id="pidstat-1"><a href="#pidstat-1" class="headerlink" title="pidstat 1"></a>pidstat 1</h3><p>查看每个进程的CPU占用率</p><h3 id="iostat-xz-1"><a href="#iostat-xz-1" class="headerlink" title="iostat -xz 1"></a>iostat -xz 1</h3><ol><li><code>r/s w/s</code> 表示读写秒读写次数</li><li>await：IO操作平均等待时间（ms）</li><li>%util：设备利用率。表示设备的繁忙程度，超过60会影响IO性能，达到100%说明硬件已经饱和</li></ol><h3 id="sar-n-DEV-1"><a href="#sar-n-DEV-1" class="headerlink" title="sar -n DEV 1"></a>sar -n DEV 1</h3><p>查看网络设备的吞吐率。rxkB表示每秒吞吐的数据量。</p><h3 id="sar-n-TCP-ETCP-1"><a href="#sar-n-TCP-ETCP-1" class="headerlink" title="sar -n TCP,ETCP 1"></a>sar -n TCP,ETCP 1</h3><p>查看TCP连接状态</p><ol><li><code>active/s</code> ：每秒本地发起的TCP（connect）连接数</li><li><code>passive/s</code>：每秒远程发起的TCP（accept）连接数</li><li><code>retrans/s</code>：每秒TCP重传数量</li></ol><h2 id="2017-04-01-从日志统计到大数据分析"><a href="#2017-04-01-从日志统计到大数据分析" class="headerlink" title="2017-04-01 从日志统计到大数据分析"></a>2017-04-01 从日志统计到大数据分析</h2><p><a href="https://zhuanlan.zhihu.com/p/20477493?columnSlug=sangwf" target="_blank" rel="noopener">原文链接</a><br><img src="https://longlog-1300108443.cos.ap-beijing.myqcloud.com/before2019/2017-05-19-14909389945639.jpg" alt=""></p><p>不管是推进公司的日志采集结构化，还是提供更强大的查询引擎，都是在尝试把这条流建设的更好。</p><h3 id="数据采集"><a href="#数据采集" class="headerlink" title="数据采集"></a>数据采集</h3><ol><li>初始的数据源尽量全而细</li><li>源头进行结构化、预处理能大大降低后期成本</li><li>对存储的数据进行抽象，区分类型（行为数据、业务数据）<br>ETL（Extract-Transform-Load）是对对数据进行抽取、变换和加载的过程。数据源预处理的越好，ETL过程就能越简单。</li></ol><h3 id="数据传输"><a href="#数据传输" class="headerlink" title="数据传输"></a>数据传输</h3><p>避免重复造轮子</p><ol><li>Sqoop：用于传统数据库和Hadoop之间的数据传输。</li><li>Scribe：Facebook开源的一套日志传输系统，将源日志传输到Hadoop等分布式文件系统中。</li><li>Flume：Cloudera开源的一套日志传输系统，和Scribe类似。</li><li>Kafka：Linkedin开源的一套消息传输系统。</li></ol><h3 id="数据驱动"><a href="#数据驱动" class="headerlink" title="数据驱动"></a>数据驱动</h3><p>理想状态：服务方数据准备好，又提供强大的工具，需求方自行处理数据分析需求。</p><h3 id="数据分析"><a href="#数据分析" class="headerlink" title="数据分析"></a>数据分析</h3><p>漏斗分析和留存分析<br><a href="https://zhuanlan.zhihu.com/p/20512931?columnSlug=sangwf" target="_blank" rel="noopener">分析case</a><br><strong>数据分析的最终目的是数据驱动产品</strong></p><h3 id="数据系统的架构"><a href="#数据系统的架构" class="headerlink" title="数据系统的架构"></a>数据系统的架构</h3><p><img src="https://longlog-1300108443.cos.ap-beijing.myqcloud.com/before2019/2017-05-19-14909466663411.jpg" alt=""><br>横向为上文说的数据流，纵向包含三个重要的系统：调度系统、监控系统、元数据系统。<br>调度器的核心功能：一是定时器；二是优化资源利用，特别是任务优先级的控制；三是管理任务依赖关系</p><h3 id="元数据"><a href="#元数据" class="headerlink" title="元数据"></a>元数据</h3><ul><li>数据的Schema：表、字段定义等。</li><li>数据的就绪状态：数据就绪时间、存放位置等动态信息。</li><li>元数据的访问API。<br>拓展：</li><li>权限控制</li><li>元数据变更记录</li></ul><h4 id="元数据的好处"><a href="#元数据的好处" class="headerlink" title="元数据的好处"></a>元数据的好处</h4><ol><li>可以作为数据平台内部模块间通讯的接口</li><li>数据发现</li></ol></div></article><section class="disqus-comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></section></div><script type="text/javascript">!function(){var t=document.getElementsByTagName("article")[0];if(null!=t){imgs=t.getElementsByTagName("img");for(var e=0;e<imgs.length;e++)img=imgs[e],width=parseInt(img.getAttribute("alt").replace("-w","")),0<width&&img.setAttribute("style","width:"+width+"px")}}()</script><script>var disqus_shortname="apeipo",disqus_url="http://longlog.me/2017/05/19/read-note-44/";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script></body>